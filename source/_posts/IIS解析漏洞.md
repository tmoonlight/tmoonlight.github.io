---
title: IIS解析漏洞
date: 2015/11/24 2:59:35
tags:
---


[](http://www.vidun.com/VwInfoMonitorHelp/)

  


    在 Windows 2003 IIS 6.0 下有两个漏洞，微软一直没有给出补丁。

  


    **漏洞1：**

    在网站下建立夹，其目录内的任何扩展名的文件都被 IIS 当作 asp 文件来解析并执行。例如创建目录 vidun.asp，那么 /vidun.asp/1.jpg 将被当作 asp 文件来文件夹的名字为 *.asp、*.asa 的文件执行。

    那么我们来测试一下，在网站下创建一个目录“vidun.asp”，并在目录下创建一个文件名为“1.jpg”的文件(假设是用户作为头像上传上来的)， 用记事本打开“1.jpg”文件，输入：

  


Now is: <%=Now()%>

  


    如图所示，如果其中的 asp 脚本能被执行，那么恭喜您：漏洞存在。

    打开浏览器，输入地址，执行效果如下：

    **漏洞2：**

    网站上传图片的时候，将网页木马文件的名字改成“*.asp;.jpg”，也同样会被 IIS 当作 asp 文件来解析并执行。例如上传一个图片文件，名字叫“vidun.asp;.jpg”的木马文件，该文件可以被当作 asp 文件解析并执行。

    在网站目录下创建文件“vidun.asp;.jpg”，代码内容与上面 1.jpg 相同，打开浏览器，输入地址，执行效果如下 ：

    这两个漏洞实在太可怕了，足以让每一个站长望而崩溃，更让站长崩溃的是微软至今没有发布补丁！

[](http://www.vidun.com/VwInfoMonitorHelp/)

 **如何避免“IIS解析漏洞”？**

  


    在我写这篇文章的时候，微软依然没有发布任何补丁。这个漏洞已经使得无数网站遭受攻击。

  


    程序开发者应该如何避免该漏洞被利用？

    1，必须在写程序的时候特别注意，上传图片后一定要用随机的数字或英文来重命名，文件名中最好不要含有其他字符，更不能让用户定义图片文件的名字。

    2，对于网盘系统来说，如果支持目录创建并允许用户自定义目录名，且在真实的物理磁盘上创建了这个目录的话，必须注意：目录名必须要严格检查，最好是只允许输入英文和数字。但最好是用数据库记录文件夹的层次结构，不要让用户知道真实的磁盘地址对应。

  


  

